{"version":3,"file":"croppie.min.js","sources":["../src/croppie.js"],"sourcesContent":["/*eslint-disable*/\r\n\r\n/*************************\r\n * Croppie\r\n * Copyright 2019\r\n * Foliotek\r\n * Version: 2.6.5\r\n *************************/\r\n(function (root, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        // AMD. Register as an anonymous module.\r\n        define(factory);\r\n    } else if (typeof exports === 'object' && typeof exports.nodeName !== 'string') {\r\n        // CommonJS\r\n        module.exports = factory();\r\n    } else {\r\n        // Browser globals\r\n        root.Croppie = factory();\r\n    }\r\n}(typeof self !== 'undefined' ? self : this, function () {\r\n\r\n    /* Polyfills */\r\n    if (typeof Promise !== 'function') {\r\n        /*! promise-polyfill 3.1.0 */\r\n        !function(a){function b(a,b){return function(){a.apply(b,arguments)}}function c(a){if(\"object\"!==typeof this)throw new TypeError(\"Promises must be constructed via new\");if(\"function\"!==typeof a)throw new TypeError(\"not a function\");this._state=null,this._value=null,this._deferreds=[],i(a,b(e,this),b(f,this))}function d(a){var b=this;return null===this._state?void this._deferreds.push(a):void k(function(){var c=b._state?a.onFulfilled:a.onRejected;if(null===c)return void(b._state?a.resolve:a.reject)(b._value);var d;try{d=c(b._value)}catch(e){return void a.reject(e)}a.resolve(d)})}function e(a){try{if(a===this)throw new TypeError(\"A promise cannot be resolved with itself.\");if(a&&(\"object\"===typeof a||\"function\"===typeof a)){var c=a.then;if(\"function\"===typeof c)return void i(b(c,a),b(e,this),b(f,this))}this._state=!0,this._value=a,g.call(this)}catch(d){f.call(this,d)}}function f(a){this._state=!1,this._value=a,g.call(this)}function g(){for(var a=0,b=this._deferreds.length;b>a;a++)d.call(this,this._deferreds[a]);this._deferreds=null}function h(a,b,c,d){this.onFulfilled=\"function\"===typeof a?a:null,this.onRejected=\"function\"===typeof b?b:null,this.resolve=c,this.reject=d}function i(a,b,c){var d=!1;try{a(function(a){d||(d=!0,b(a))},function(a){d||(d=!0,c(a))})}catch(e){if(d)return;d=!0,c(e)}}var j=setTimeout,k=\"function\"===typeof setImmediate&&setImmediate||function(a){j(a,1)},l=Array.isArray||function(a){return\"[object Array]\"===Object.prototype.toString.call(a)};c.prototype[\"catch\"]=function(a){return this.then(null,a)},c.prototype.then=function(a,b){var e=this;return new c(function(c,f){d.call(e,new h(a,b,c,f))})},c.all=function(){var a=Array.prototype.slice.call(1===arguments.length&&l(arguments[0])?arguments[0]:arguments);return new c(function(b,c){function d(f,g){try{if(g&&(\"object\"===typeof g||\"function\"===typeof g)){var h=g.then;if(\"function\"===typeof h)return void h.call(g,function(a){d(f,a)},c)}a[f]=g,0===--e&&b(a)}catch(i){c(i)}}if(0===a.length)return b([]);for(var e=a.length,f=0;f<a.length;f++)d(f,a[f])})},c.resolve=function(a){return a&&\"object\"===typeof a&&a.constructor===c?a:new c(function(b){b(a)})},c.reject=function(a){return new c(function(b,c){c(a)})},c.race=function(a){return new c(function(b,c){for(var d=0,e=a.length;e>d;d++)a[d].then(b,c)})},c._setImmediateFn=function(a){k=a},\"undefined\"!==typeof module&&module.exports?module.exports=c:a.Promise||(a.Promise=c)}(this);\r\n    }\r\n\r\n    if (typeof window !== 'undefined' && typeof window.CustomEvent !== \"function\") {\r\n        (function(){\r\n            function CustomEvent ( event, params ) {\r\n                params = params || { bubbles: false, cancelable: false, detail: undefined };\r\n                var evt = document.createEvent( 'CustomEvent' );\r\n                evt.initCustomEvent( event, params.bubbles, params.cancelable, params.detail );\r\n                return evt;\r\n            }\r\n            CustomEvent.prototype = window.Event.prototype;\r\n            window.CustomEvent = CustomEvent;\r\n        }());\r\n    }\r\n\r\n    if (typeof HTMLCanvasElement !== 'undefined' && !HTMLCanvasElement.prototype.toBlob) {\r\n        Object.defineProperty(HTMLCanvasElement.prototype, 'toBlob', {\r\n            value: function (callback, type, quality) {\r\n                var binStr = atob( this.toDataURL(type, quality).split(',')[1] ),\r\n                len = binStr.length,\r\n                arr = new Uint8Array(len);\r\n\r\n                for (var i=0; i<len; i++ ) {\r\n                    arr[i] = binStr.charCodeAt(i);\r\n                }\r\n\r\n                callback( new Blob( [arr], {type: type || 'image/png'} ) );\r\n            }\r\n        });\r\n    }\r\n    /* End Polyfills */\r\n\r\n    var cssPrefixes = ['Webkit', 'Moz', 'ms'],\r\n        emptyStyles = typeof document !== 'undefined' ? document.createElement('div').style : {},\r\n        EXIF_NORM = [1,8,3,6],\r\n        EXIF_FLIP = [2,7,4,5],\r\n        CSS_TRANS_ORG,\r\n        CSS_TRANSFORM,\r\n        CSS_USERSELECT;\r\n\r\n    function vendorPrefix(prop) {\r\n        if (prop in emptyStyles) {\r\n            return prop;\r\n        }\r\n\r\n        var capProp = prop[0].toUpperCase() + prop.slice(1),\r\n            i = cssPrefixes.length;\r\n\r\n        while (i--) {\r\n            prop = cssPrefixes[i] + capProp;\r\n            if (prop in emptyStyles) {\r\n                return prop;\r\n            }\r\n        }\r\n    }\r\n\r\n    CSS_TRANSFORM = vendorPrefix('transform');\r\n    CSS_TRANS_ORG = vendorPrefix('transformOrigin');\r\n    CSS_USERSELECT = vendorPrefix('userSelect');\r\n\r\n    function getExifOffset(ornt, rotate) {\r\n        var arr = EXIF_NORM.indexOf(ornt) > -1 ? EXIF_NORM : EXIF_FLIP,\r\n            index = arr.indexOf(ornt),\r\n            offset = (rotate / 90) % arr.length;// 180 = 2%4 = 2 shift exif by 2 indexes\r\n\r\n        return arr[(arr.length + index + (offset % arr.length)) % arr.length];\r\n    }\r\n\r\n    // Credits to : Andrew Dupont - http://andrewdupont.net/2009/08/28/deep-extending-objects-in-javascript/\r\n    function deepExtend(destination, source) {\r\n        destination = destination || {};\r\n        for (var property in source) {\r\n            if (source[property] && source[property].constructor && source[property].constructor === Object) {\r\n                destination[property] = destination[property] || {};\r\n                deepExtend(destination[property], source[property]);\r\n            } else {\r\n                destination[property] = source[property];\r\n            }\r\n        }\r\n        return destination;\r\n    }\r\n\r\n    function clone(object) {\r\n        return deepExtend({}, object);\r\n    }\r\n\r\n    function debounce(func, wait, immediate) {\r\n        var timeout;\r\n        return function () {\r\n            var context = this, args = arguments;\r\n            var later = function () {\r\n                timeout = null;\r\n                if (!immediate) func.apply(context, args);\r\n            };\r\n            var callNow = immediate && !timeout;\r\n            clearTimeout(timeout);\r\n            timeout = setTimeout(later, wait);\r\n            if (callNow) func.apply(context, args);\r\n        };\r\n    }\r\n\r\n    function dispatchChange(element) {\r\n        if (\"createEvent\" in document) {\r\n            var evt = document.createEvent(\"HTMLEvents\");\r\n            evt.initEvent(\"change\", false, true);\r\n            element.dispatchEvent(evt);\r\n        }\r\n        else {\r\n            element.fireEvent(\"onchange\");\r\n        }\r\n    }\r\n\r\n    //http://jsperf.com/vanilla-css\r\n    function css(el, styles, val) {\r\n        if (typeof (styles) === 'string') {\r\n            var tmp = styles;\r\n            styles = {};\r\n            styles[tmp] = val;\r\n        }\r\n\r\n        for (var prop in styles) {\r\n            el.style[prop] = styles[prop];\r\n        }\r\n    }\r\n\r\n    function addClass(el, c) {\r\n        if (el.classList) {\r\n            el.classList.add(c);\r\n        }\r\n        else {\r\n            el.className += ' ' + c;\r\n        }\r\n    }\r\n\r\n    function removeClass(el, c) {\r\n        if (el.classList) {\r\n            el.classList.remove(c);\r\n        }\r\n        else {\r\n            el.className = el.className.replace(c, '');\r\n        }\r\n    }\r\n\r\n    function setAttributes(el, attrs) {\r\n        for (var key in attrs) {\r\n            el.setAttribute(key, attrs[key]);\r\n        }\r\n    }\r\n\r\n    function num(v) {\r\n        return parseInt(v, 10);\r\n    }\r\n\r\n    /* Utilities */\r\n    function loadImage(src, doExif) {\r\n        if (!src) { throw 'Source image missing'; }\r\n\r\n        var img = new Image();\r\n        img.style.opacity = '0';\r\n        return new Promise(function (resolve, reject) {\r\n            function _resolve() {\r\n                img.style.opacity = '1';\r\n                setTimeout(function () {\r\n                    resolve(img);\r\n                }, 1);\r\n            }\r\n\r\n            img.removeAttribute('crossOrigin');\r\n            if (src.match(/^https?:\\/\\/|^\\/\\//)) {\r\n                img.setAttribute('crossOrigin', 'anonymous');\r\n            }\r\n\r\n            img.onload = function () {\r\n                if (doExif) {\r\n                    EXIF.getData(img, function () {\r\n                        _resolve();\r\n                    });\r\n                }\r\n                else {\r\n                    _resolve();\r\n                }\r\n            };\r\n            img.onerror = function (ev) {\r\n                img.style.opacity = 1;\r\n                setTimeout(function () {\r\n                    reject(ev);\r\n                }, 1);\r\n            };\r\n            img.src = src;\r\n        });\r\n    }\r\n\r\n    function naturalImageDimensions(img, ornt) {\r\n        var w = img.naturalWidth;\r\n        var h = img.naturalHeight;\r\n        var orient = ornt || getExifOrientation(img);\r\n        if (orient && orient >= 5) {\r\n            var x= w;\r\n            w = h;\r\n            h = x;\r\n        }\r\n        return { width: w, height: h };\r\n    }\r\n\r\n    /* CSS Transform Prototype */\r\n    var TRANSLATE_OPTS = {\r\n        'translate3d': {\r\n            suffix: ', 0px'\r\n        },\r\n        'translate': {\r\n            suffix: ''\r\n        }\r\n    };\r\n    var Transform = function (x, y, scale) {\r\n        this.x = parseFloat(x);\r\n        this.y = parseFloat(y);\r\n        this.scale = parseFloat(scale);\r\n    };\r\n\r\n    Transform.parse = function (v) {\r\n        if (v.style) {\r\n            return Transform.parse(v.style[CSS_TRANSFORM]);\r\n        }\r\n        else if (v.indexOf('matrix') > -1 || v.indexOf('none') > -1) {\r\n            return Transform.fromMatrix(v);\r\n        }\r\n        else {\r\n            return Transform.fromString(v);\r\n        }\r\n    };\r\n\r\n    Transform.fromMatrix = function (v) {\r\n        var vals = v.substring(7).split(',');\r\n        if (!vals.length || v === 'none') {\r\n            vals = [1, 0, 0, 1, 0, 0];\r\n        }\r\n\r\n        return new Transform(num(vals[4]), num(vals[5]), parseFloat(vals[0]));\r\n    };\r\n\r\n    Transform.fromString = function (v) {\r\n        var values = v.split(') '),\r\n            translate = values[0].substring(Croppie.globals.translate.length + 1).split(','),\r\n            scale = values.length > 1 ? values[1].substring(6) : 1,\r\n            x = translate.length > 1 ? translate[0] : 0,\r\n            y = translate.length > 1 ? translate[1] : 0;\r\n\r\n        return new Transform(x, y, scale);\r\n    };\r\n\r\n    Transform.prototype.toString = function () {\r\n        var suffix = TRANSLATE_OPTS[Croppie.globals.translate].suffix || '';\r\n        return Croppie.globals.translate + '(' + this.x + 'px, ' + this.y + 'px' + suffix + ') scale(' + this.scale + ')';\r\n    };\r\n\r\n    var TransformOrigin = function (el) {\r\n        if (!el || !el.style[CSS_TRANS_ORG]) {\r\n            this.x = 0;\r\n            this.y = 0;\r\n            return;\r\n        }\r\n        var css = el.style[CSS_TRANS_ORG].split(' ');\r\n        this.x = parseFloat(css[0]);\r\n        this.y = parseFloat(css[1]);\r\n    };\r\n\r\n    TransformOrigin.prototype.toString = function () {\r\n        return this.x + 'px ' + this.y + 'px';\r\n    };\r\n\r\n    function getExifOrientation (img) {\r\n        return img.exifdata && img.exifdata.Orientation ? num(img.exifdata.Orientation) : 1;\r\n    }\r\n\r\n    function drawCanvas(canvas, img, orientation) {\r\n        var width = img.width,\r\n            height = img.height,\r\n            ctx = canvas.getContext('2d');\r\n\r\n        canvas.width = img.width;\r\n        canvas.height = img.height;\r\n\r\n        ctx.save();\r\n        switch (orientation) {\r\n          case 2:\r\n             ctx.translate(width, 0);\r\n             ctx.scale(-1, 1);\r\n             break;\r\n\r\n          case 3:\r\n              ctx.translate(width, height);\r\n              ctx.rotate(180*Math.PI/180);\r\n              break;\r\n\r\n          case 4:\r\n              ctx.translate(0, height);\r\n              ctx.scale(1, -1);\r\n              break;\r\n\r\n          case 5:\r\n              canvas.width = height;\r\n              canvas.height = width;\r\n              ctx.rotate(90*Math.PI/180);\r\n              ctx.scale(1, -1);\r\n              break;\r\n\r\n          case 6:\r\n              canvas.width = height;\r\n              canvas.height = width;\r\n              ctx.rotate(90*Math.PI/180);\r\n              ctx.translate(0, -height);\r\n              break;\r\n\r\n          case 7:\r\n              canvas.width = height;\r\n              canvas.height = width;\r\n              ctx.rotate(-90*Math.PI/180);\r\n              ctx.translate(-width, height);\r\n              ctx.scale(1, -1);\r\n              break;\r\n\r\n          case 8:\r\n              canvas.width = height;\r\n              canvas.height = width;\r\n              ctx.translate(0, width);\r\n              ctx.rotate(-90*Math.PI/180);\r\n              break;\r\n        }\r\n        ctx.drawImage(img, 0,0, width, height);\r\n        ctx.restore();\r\n    }\r\n\r\n    /* Private Methods */\r\n    function _create() {\r\n        var self = this,\r\n            contClass = 'croppie-container',\r\n            customViewportClass = self.options.viewport.type ? 'cr-vp-' + self.options.viewport.type : null,\r\n            boundary, img, viewport, overlay, bw, bh;\r\n\r\n        self.options.useCanvas = self.options.enableOrientation || _hasExif.call(self);\r\n        // Properties on class\r\n        self.data = {};\r\n        self.elements = {};\r\n\r\n        boundary = self.elements.boundary = document.createElement('div');\r\n        viewport = self.elements.viewport = document.createElement('div');\r\n        img = self.elements.img = document.createElement('img');\r\n        overlay = self.elements.overlay = document.createElement('div');\r\n\r\n        if (self.options.useCanvas) {\r\n            self.elements.canvas = document.createElement('canvas');\r\n            self.elements.preview = self.elements.canvas;\r\n        }\r\n        else {\r\n            self.elements.preview = img;\r\n        }\r\n\r\n        addClass(boundary, 'cr-boundary');\r\n        boundary.setAttribute('aria-dropeffect', 'none');\r\n        bw = self.options.boundary.width;\r\n        bh = self.options.boundary.height;\r\n        css(boundary, {\r\n            width: (bw + (isNaN(bw) ? '' : 'px')),\r\n            height: (bh + (isNaN(bh) ? '' : 'px'))\r\n        });\r\n\r\n        addClass(viewport, 'cr-viewport');\r\n        if (customViewportClass) {\r\n            addClass(viewport, customViewportClass);\r\n        }\r\n        css(viewport, {\r\n            width: self.options.viewport.width + 'px',\r\n            height: self.options.viewport.height + 'px'\r\n        });\r\n        viewport.setAttribute('tabindex', 0);\r\n\r\n        addClass(self.elements.preview, 'cr-image');\r\n        setAttributes(self.elements.preview, { 'alt': 'preview', 'aria-grabbed': 'false' });\r\n        addClass(overlay, 'cr-overlay');\r\n\r\n        self.element.appendChild(boundary);\r\n        boundary.appendChild(self.elements.preview);\r\n        boundary.appendChild(viewport);\r\n        boundary.appendChild(overlay);\r\n\r\n        addClass(self.element, contClass);\r\n        if (self.options.customClass) {\r\n            addClass(self.element, self.options.customClass);\r\n        }\r\n\r\n        _initDraggable.call(this);\r\n\r\n        if (self.options.enableZoom) {\r\n            _initializeZoom.call(self);\r\n        }\r\n\r\n        // if (self.options.enableOrientation) {\r\n        //     _initRotationControls.call(self);\r\n        // }\r\n\r\n        if (self.options.enableResize) {\r\n            _initializeResize.call(self);\r\n        }\r\n    }\r\n\r\n    // function _initRotationControls () {\r\n    //     var self = this,\r\n    //         wrap, btnLeft, btnRight, iLeft, iRight;\r\n\r\n    //     wrap = document.createElement('div');\r\n    //     self.elements.orientationBtnLeft = btnLeft = document.createElement('button');\r\n    //     self.elements.orientationBtnRight = btnRight = document.createElement('button');\r\n\r\n    //     wrap.appendChild(btnLeft);\r\n    //     wrap.appendChild(btnRight);\r\n\r\n    //     iLeft = document.createElement('i');\r\n    //     iRight = document.createElement('i');\r\n    //     btnLeft.appendChild(iLeft);\r\n    //     btnRight.appendChild(iRight);\r\n\r\n    //     addClass(wrap, 'cr-rotate-controls');\r\n    //     addClass(btnLeft, 'cr-rotate-l');\r\n    //     addClass(btnRight, 'cr-rotate-r');\r\n\r\n    //     self.elements.boundary.appendChild(wrap);\r\n\r\n    //     btnLeft.addEventListener('click', function () {\r\n    //         self.rotate(-90);\r\n    //     });\r\n    //     btnRight.addEventListener('click', function () {\r\n    //         self.rotate(90);\r\n    //     });\r\n    // }\r\n\r\n    function _hasExif() {\r\n        return this.options.enableExif && window.EXIF;\r\n    }\r\n\r\n    function _initializeResize () {\r\n        var self = this;\r\n        var wrap = document.createElement('div');\r\n        var isDragging = false;\r\n        var direction;\r\n        var originalX;\r\n        var originalY;\r\n        var minSize = 50;\r\n        var maxWidth;\r\n        var maxHeight;\r\n        var vr;\r\n        var hr;\r\n\r\n        addClass(wrap, 'cr-resizer');\r\n        css(wrap, {\r\n            width: this.options.viewport.width + 'px',\r\n            height: this.options.viewport.height + 'px'\r\n        });\r\n\r\n        if (this.options.resizeControls.height) {\r\n            vr = document.createElement('div');\r\n            addClass(vr, 'cr-resizer-vertical');\r\n            wrap.appendChild(vr);\r\n        }\r\n\r\n        if (this.options.resizeControls.width) {\r\n            hr = document.createElement('div');\r\n            addClass(hr, 'cr-resizer-horisontal');\r\n            wrap.appendChild(hr);\r\n        }\r\n\r\n        function mouseDown(ev) {\r\n            if (ev.button !== undefined && ev.button !== 0) return;\r\n\r\n            ev.preventDefault();\r\n            if (isDragging) {\r\n                return;\r\n            }\r\n\r\n            var overlayRect = self.elements.overlay.getBoundingClientRect();\r\n\r\n            isDragging = true;\r\n            originalX = ev.pageX;\r\n            originalY = ev.pageY;\r\n            direction = ev.currentTarget.className.indexOf('vertical') !== -1 ? 'v' : 'h';\r\n            maxWidth = overlayRect.width;\r\n            maxHeight = overlayRect.height;\r\n\r\n            if (ev.touches) {\r\n                var touches = ev.touches[0];\r\n                originalX = touches.pageX;\r\n                originalY = touches.pageY;\r\n            }\r\n\r\n            window.addEventListener('mousemove', mouseMove);\r\n            window.addEventListener('touchmove', mouseMove);\r\n            window.addEventListener('mouseup', mouseUp);\r\n            window.addEventListener('touchend', mouseUp);\r\n            document.body.style[CSS_USERSELECT] = 'none';\r\n        }\r\n\r\n        function mouseMove(ev) {\r\n            var pageX = ev.pageX;\r\n            var pageY = ev.pageY;\r\n\r\n            ev.preventDefault();\r\n\r\n            if (ev.touches) {\r\n                var touches = ev.touches[0];\r\n                pageX = touches.pageX;\r\n                pageY = touches.pageY;\r\n            }\r\n\r\n            var deltaX = pageX - originalX;\r\n            var deltaY = pageY - originalY;\r\n            var newHeight = self.options.viewport.height + deltaY;\r\n            var newWidth = self.options.viewport.width + deltaX;\r\n\r\n            if (direction === 'v' && newHeight >= minSize && newHeight <= maxHeight) {\r\n                css(wrap, {\r\n                    height: newHeight + 'px'\r\n                });\r\n\r\n                self.options.boundary.height += deltaY;\r\n                css(self.elements.boundary, {\r\n                    height: self.options.boundary.height + 'px'\r\n                });\r\n\r\n                self.options.viewport.height += deltaY;\r\n                css(self.elements.viewport, {\r\n                    height: self.options.viewport.height + 'px'\r\n                });\r\n            }\r\n            else if (direction === 'h' && newWidth >= minSize && newWidth <= maxWidth) {\r\n                css(wrap, {\r\n                    width: newWidth + 'px'\r\n                });\r\n\r\n                self.options.boundary.width += deltaX;\r\n                css(self.elements.boundary, {\r\n                    width: self.options.boundary.width + 'px'\r\n                });\r\n\r\n                self.options.viewport.width += deltaX;\r\n                css(self.elements.viewport, {\r\n                    width: self.options.viewport.width + 'px'\r\n                });\r\n            }\r\n\r\n            _updateOverlay.call(self);\r\n            _updateZoomLimits.call(self);\r\n            _updateCenterPoint.call(self);\r\n            _triggerUpdate.call(self);\r\n            originalY = pageY;\r\n            originalX = pageX;\r\n        }\r\n\r\n        function mouseUp() {\r\n            isDragging = false;\r\n            window.removeEventListener('mousemove', mouseMove);\r\n            window.removeEventListener('touchmove', mouseMove);\r\n            window.removeEventListener('mouseup', mouseUp);\r\n            window.removeEventListener('touchend', mouseUp);\r\n            document.body.style[CSS_USERSELECT] = '';\r\n        }\r\n\r\n        if (vr) {\r\n            vr.addEventListener('mousedown', mouseDown);\r\n            vr.addEventListener('touchstart', mouseDown);\r\n        }\r\n\r\n        if (hr) {\r\n            hr.addEventListener('mousedown', mouseDown);\r\n            hr.addEventListener('touchstart', mouseDown);\r\n        }\r\n\r\n        this.elements.boundary.appendChild(wrap);\r\n    }\r\n\r\n    function _setZoomerVal(v) {\r\n        if (this.options.enableZoom) {\r\n            var z = this.elements.zoomer,\r\n                val = fix(v, 4);\r\n\r\n            z.value = Math.max(parseFloat(z.min), Math.min(parseFloat(z.max), val)).toString();\r\n        }\r\n    }\r\n\r\n    function _initializeZoom() {\r\n        var self = this,\r\n            wrap = self.elements.zoomerWrap = document.createElement('div'),\r\n            zoomer = self.elements.zoomer = document.createElement('input');\r\n\r\n        addClass(wrap, 'cr-slider-wrap');\r\n        addClass(zoomer, 'cr-slider');\r\n        zoomer.type = 'range';\r\n        zoomer.step = '0.0001';\r\n        zoomer.value = '1';\r\n        zoomer.style.display = self.options.showZoomer ? '' : 'none';\r\n        zoomer.setAttribute('aria-label', 'zoom');\r\n\r\n        self.element.appendChild(wrap);\r\n        wrap.appendChild(zoomer);\r\n\r\n        self._currentZoom = 1;\r\n\r\n        function change() {\r\n            _onZoom.call(self, {\r\n                value: parseFloat(zoomer.value),\r\n                origin: new TransformOrigin(self.elements.preview),\r\n                viewportRect: self.elements.viewport.getBoundingClientRect(),\r\n                transform: Transform.parse(self.elements.preview)\r\n            });\r\n        }\r\n\r\n        function scroll(ev) {\r\n            var delta, targetZoom;\r\n\r\n            if(self.options.mouseWheelZoom === 'ctrl' && ev.ctrlKey !== true){\r\n              return 0;\r\n            } else if (ev.wheelDelta) {\r\n                delta = ev.wheelDelta / 1200; //wheelDelta min: -120 max: 120 // max x 10 x 2\r\n            } else if (ev.deltaY) {\r\n                delta = ev.deltaY / 1060; //deltaY min: -53 max: 53 // max x 10 x 2\r\n            } else if (ev.detail) {\r\n                delta = ev.detail / -60; //delta min: -3 max: 3 // max x 10 x 2\r\n            } else {\r\n                delta = 0;\r\n            }\r\n\r\n            targetZoom = self._currentZoom + (delta * self._currentZoom);\r\n\r\n            ev.preventDefault();\r\n            _setZoomerVal.call(self, targetZoom);\r\n            change.call(self);\r\n        }\r\n\r\n        self.elements.zoomer.addEventListener('input', change);// this is being fired twice on keypress\r\n        self.elements.zoomer.addEventListener('change', change);\r\n\r\n        if (self.options.mouseWheelZoom) {\r\n            self.elements.boundary.addEventListener('mousewheel', scroll);\r\n            self.elements.boundary.addEventListener('DOMMouseScroll', scroll);\r\n        }\r\n    }\r\n\r\n    function _onZoom(ui) {\r\n        var self = this,\r\n            transform = ui ? ui.transform : Transform.parse(self.elements.preview),\r\n            vpRect = ui ? ui.viewportRect : self.elements.viewport.getBoundingClientRect(),\r\n            origin = ui ? ui.origin : new TransformOrigin(self.elements.preview);\r\n\r\n        function applyCss() {\r\n            var transCss = {};\r\n            transCss[CSS_TRANSFORM] = transform.toString();\r\n            transCss[CSS_TRANS_ORG] = origin.toString();\r\n            css(self.elements.preview, transCss);\r\n        }\r\n\r\n        self._currentZoom = ui ? ui.value : self._currentZoom;\r\n        transform.scale = self._currentZoom;\r\n        self.elements.zoomer.setAttribute('aria-valuenow', self._currentZoom);\r\n        applyCss();\r\n\r\n        if (self.options.enforceBoundary) {\r\n            var boundaries = _getVirtualBoundaries.call(self, vpRect),\r\n                transBoundaries = boundaries.translate,\r\n                oBoundaries = boundaries.origin;\r\n\r\n            if (transform.x >= transBoundaries.maxX) {\r\n                origin.x = oBoundaries.minX;\r\n                transform.x = transBoundaries.maxX;\r\n            }\r\n\r\n            if (transform.x <= transBoundaries.minX) {\r\n                origin.x = oBoundaries.maxX;\r\n                transform.x = transBoundaries.minX;\r\n            }\r\n\r\n            if (transform.y >= transBoundaries.maxY) {\r\n                origin.y = oBoundaries.minY;\r\n                transform.y = transBoundaries.maxY;\r\n            }\r\n\r\n            if (transform.y <= transBoundaries.minY) {\r\n                origin.y = oBoundaries.maxY;\r\n                transform.y = transBoundaries.minY;\r\n            }\r\n        }\r\n        applyCss();\r\n        _debouncedOverlay.call(self);\r\n        _triggerUpdate.call(self);\r\n    }\r\n\r\n    function _getVirtualBoundaries(viewport) {\r\n        var self = this,\r\n            scale = self._currentZoom,\r\n            vpWidth = viewport.width,\r\n            vpHeight = viewport.height,\r\n            centerFromBoundaryX = self.elements.boundary.clientWidth / 2,\r\n            centerFromBoundaryY = self.elements.boundary.clientHeight / 2,\r\n            imgRect = self.elements.preview.getBoundingClientRect(),\r\n            curImgWidth = imgRect.width,\r\n            curImgHeight = imgRect.height,\r\n            halfWidth = vpWidth / 2,\r\n            halfHeight = vpHeight / 2;\r\n\r\n        var maxX = ((halfWidth / scale) - centerFromBoundaryX) * -1;\r\n        var minX = maxX - ((curImgWidth * (1 / scale)) - (vpWidth * (1 / scale)));\r\n\r\n        var maxY = ((halfHeight / scale) - centerFromBoundaryY) * -1;\r\n        var minY = maxY - ((curImgHeight * (1 / scale)) - (vpHeight * (1 / scale)));\r\n\r\n        var originMinX = (1 / scale) * halfWidth;\r\n        var originMaxX = (curImgWidth * (1 / scale)) - originMinX;\r\n\r\n        var originMinY = (1 / scale) * halfHeight;\r\n        var originMaxY = (curImgHeight * (1 / scale)) - originMinY;\r\n\r\n        return {\r\n            translate: {\r\n                maxX: maxX,\r\n                minX: minX,\r\n                maxY: maxY,\r\n                minY: minY\r\n            },\r\n            origin: {\r\n                maxX: originMaxX,\r\n                minX: originMinX,\r\n                maxY: originMaxY,\r\n                minY: originMinY\r\n            }\r\n        };\r\n    }\r\n\r\n    function _updateCenterPoint(rotate) {\r\n        var self = this,\r\n            scale = self._currentZoom,\r\n            data = self.elements.preview.getBoundingClientRect(),\r\n            vpData = self.elements.viewport.getBoundingClientRect(),\r\n            transform = Transform.parse(self.elements.preview.style[CSS_TRANSFORM]),\r\n            pc = new TransformOrigin(self.elements.preview),\r\n            top = (vpData.top - data.top) + (vpData.height / 2),\r\n            left = (vpData.left - data.left) + (vpData.width / 2),\r\n            center = {},\r\n            adj = {};\r\n\r\n        if (rotate) {\r\n            var cx = pc.x;\r\n            var cy = pc.y;\r\n            var tx = transform.x;\r\n            var ty = transform.y;\r\n\r\n            center.y = cx;\r\n            center.x = cy;\r\n            transform.y = tx;\r\n            transform.x = ty;\r\n        }\r\n        else {\r\n            center.y = top / scale;\r\n            center.x = left / scale;\r\n\r\n            adj.y = (center.y - pc.y) * (1 - scale);\r\n            adj.x = (center.x - pc.x) * (1 - scale);\r\n\r\n            transform.x -= adj.x;\r\n            transform.y -= adj.y;\r\n        }\r\n\r\n        var newCss = {};\r\n        newCss[CSS_TRANS_ORG] = center.x + 'px ' + center.y + 'px';\r\n        newCss[CSS_TRANSFORM] = transform.toString();\r\n        css(self.elements.preview, newCss);\r\n    }\r\n\r\n    function _initDraggable() {\r\n        var self = this,\r\n            isDragging = false,\r\n            originalX,\r\n            originalY,\r\n            originalDistance,\r\n            vpRect,\r\n            transform;\r\n\r\n        function assignTransformCoordinates(deltaX, deltaY) {\r\n            var imgRect = self.elements.preview.getBoundingClientRect(),\r\n                top = transform.y + deltaY,\r\n                left = transform.x + deltaX;\r\n\r\n            if (self.options.enforceBoundary) {\r\n                if (vpRect.top > imgRect.top + deltaY && vpRect.bottom < imgRect.bottom + deltaY) {\r\n                    transform.y = top;\r\n                }\r\n\r\n                if (vpRect.left > imgRect.left + deltaX && vpRect.right < imgRect.right + deltaX) {\r\n                    transform.x = left;\r\n                }\r\n            }\r\n            else {\r\n                transform.y = top;\r\n                transform.x = left;\r\n            }\r\n        }\r\n\r\n        function toggleGrabState(isDragging) {\r\n          self.elements.preview.setAttribute('aria-grabbed', isDragging);\r\n          self.elements.boundary.setAttribute('aria-dropeffect', isDragging? 'move': 'none');\r\n        }\r\n\r\n        function keyDown(ev) {\r\n            var LEFT_ARROW  = 37,\r\n                UP_ARROW    = 38,\r\n                RIGHT_ARROW = 39,\r\n                DOWN_ARROW  = 40;\r\n\r\n            if (ev.shiftKey && (ev.keyCode === UP_ARROW || ev.keyCode === DOWN_ARROW)) {\r\n                var zoom;\r\n                if (ev.keyCode === UP_ARROW) {\r\n                    zoom = parseFloat(self.elements.zoomer.value) + parseFloat(self.elements.zoomer.step)\r\n                }\r\n                else {\r\n                    zoom = parseFloat(self.elements.zoomer.value) - parseFloat(self.elements.zoomer.step)\r\n                }\r\n                self.setZoom(zoom);\r\n            }\r\n            else if (self.options.enableKeyMovement && (ev.keyCode >= 37 && ev.keyCode <= 40)) {\r\n                ev.preventDefault();\r\n                var movement = parseKeyDown(ev.keyCode);\r\n\r\n                transform = Transform.parse(self.elements.preview);\r\n                document.body.style[CSS_USERSELECT] = 'none';\r\n                vpRect = self.elements.viewport.getBoundingClientRect();\r\n                keyMove(movement);\r\n            }\r\n\r\n            function parseKeyDown(key) {\r\n                switch (key) {\r\n                    case LEFT_ARROW:\r\n                        return [1, 0];\r\n                    case UP_ARROW:\r\n                        return [0, 1];\r\n                    case RIGHT_ARROW:\r\n                        return [-1, 0];\r\n                    case DOWN_ARROW:\r\n                        return [0, -1];\r\n                }\r\n            }\r\n        }\r\n\r\n        function keyMove(movement) {\r\n            var deltaX = movement[0],\r\n                deltaY = movement[1],\r\n                newCss = {};\r\n\r\n            assignTransformCoordinates(deltaX, deltaY);\r\n\r\n            newCss[CSS_TRANSFORM] = transform.toString();\r\n            css(self.elements.preview, newCss);\r\n            _updateOverlay.call(self);\r\n            document.body.style[CSS_USERSELECT] = '';\r\n            _updateCenterPoint.call(self);\r\n            _triggerUpdate.call(self);\r\n            originalDistance = 0;\r\n        }\r\n\r\n        function mouseDown(ev) {\r\n            if (ev.button !== undefined && ev.button !== 0) return;\r\n\r\n            ev.preventDefault();\r\n            if (isDragging) return;\r\n            isDragging = true;\r\n            originalX = ev.pageX;\r\n            originalY = ev.pageY;\r\n\r\n            if (ev.touches) {\r\n                var touches = ev.touches[0];\r\n                originalX = touches.pageX;\r\n                originalY = touches.pageY;\r\n            }\r\n            toggleGrabState(isDragging);\r\n            transform = Transform.parse(self.elements.preview);\r\n            window.addEventListener('mousemove', mouseMove);\r\n            window.addEventListener('touchmove', mouseMove);\r\n            window.addEventListener('mouseup', mouseUp);\r\n            window.addEventListener('touchend', mouseUp);\r\n            document.body.style[CSS_USERSELECT] = 'none';\r\n            vpRect = self.elements.viewport.getBoundingClientRect();\r\n        }\r\n\r\n        function mouseMove(ev) {\r\n            ev.preventDefault();\r\n            var pageX = ev.pageX,\r\n                pageY = ev.pageY;\r\n\r\n            if (ev.touches) {\r\n                var touches = ev.touches[0];\r\n                pageX = touches.pageX;\r\n                pageY = touches.pageY;\r\n            }\r\n\r\n            var deltaX = pageX - originalX,\r\n                deltaY = pageY - originalY,\r\n                newCss = {};\r\n\r\n            if (ev.type === 'touchmove') {\r\n                if (ev.touches.length > 1) {\r\n                    var touch1 = ev.touches[0];\r\n                    var touch2 = ev.touches[1];\r\n                    var dist = Math.sqrt((touch1.pageX - touch2.pageX) * (touch1.pageX - touch2.pageX) + (touch1.pageY - touch2.pageY) * (touch1.pageY - touch2.pageY));\r\n\r\n                    if (!originalDistance) {\r\n                        originalDistance = dist / self._currentZoom;\r\n                    }\r\n\r\n                    var scale = dist / originalDistance;\r\n\r\n                    _setZoomerVal.call(self, scale);\r\n                    dispatchChange(self.elements.zoomer);\r\n                    return;\r\n                }\r\n            }\r\n\r\n            assignTransformCoordinates(deltaX, deltaY);\r\n\r\n            newCss[CSS_TRANSFORM] = transform.toString();\r\n            css(self.elements.preview, newCss);\r\n            _updateOverlay.call(self);\r\n            originalY = pageY;\r\n            originalX = pageX;\r\n        }\r\n\r\n        function mouseUp() {\r\n            isDragging = false;\r\n            toggleGrabState(isDragging);\r\n            window.removeEventListener('mousemove', mouseMove);\r\n            window.removeEventListener('touchmove', mouseMove);\r\n            window.removeEventListener('mouseup', mouseUp);\r\n            window.removeEventListener('touchend', mouseUp);\r\n            document.body.style[CSS_USERSELECT] = '';\r\n            _updateCenterPoint.call(self);\r\n            _triggerUpdate.call(self);\r\n            originalDistance = 0;\r\n        }\r\n\r\n        self.elements.overlay.addEventListener('mousedown', mouseDown);\r\n        self.elements.viewport.addEventListener('keydown', keyDown);\r\n        self.elements.overlay.addEventListener('touchstart', mouseDown);\r\n    }\r\n\r\n    function _updateOverlay() {\r\n        if (!this.elements) return; // since this is debounced, it can be fired after destroy\r\n        var self = this,\r\n            boundRect = self.elements.boundary.getBoundingClientRect(),\r\n            imgData = self.elements.preview.getBoundingClientRect();\r\n\r\n        css(self.elements.overlay, {\r\n            width: imgData.width + 'px',\r\n            height: imgData.height + 'px',\r\n            top: (imgData.top - boundRect.top) + 'px',\r\n            left: (imgData.left - boundRect.left) + 'px'\r\n        });\r\n    }\r\n    var _debouncedOverlay = debounce(_updateOverlay, 500);\r\n\r\n    function _triggerUpdate() {\r\n        var self = this,\r\n            data = self.get();\r\n\r\n        if (!_isVisible.call(self)) {\r\n            return;\r\n        }\r\n\r\n        self.options.update.call(self, data);\r\n        if (self.$ && typeof Prototype === 'undefined') {\r\n            self.$(self.element).trigger('update.croppie', data);\r\n        }\r\n        else {\r\n            var ev;\r\n            if (window.CustomEvent) {\r\n                ev = new CustomEvent('update', { detail: data });\r\n            } else {\r\n                ev = document.createEvent('CustomEvent');\r\n                ev.initCustomEvent('update', true, true, data);\r\n            }\r\n\r\n            self.element.dispatchEvent(ev);\r\n        }\r\n    }\r\n\r\n    function _isVisible() {\r\n        return this.elements.preview.offsetHeight > 0 && this.elements.preview.offsetWidth > 0;\r\n    }\r\n\r\n    function _updatePropertiesFromImage() {\r\n        var self = this,\r\n            initialZoom = 1,\r\n            cssReset = {},\r\n            img = self.elements.preview,\r\n            imgData,\r\n            transformReset = new Transform(0, 0, initialZoom),\r\n            originReset = new TransformOrigin(),\r\n            isVisible = _isVisible.call(self);\r\n\r\n        if (!isVisible || self.data.bound) {// if the croppie isn't visible or it doesn't need binding\r\n            return;\r\n        }\r\n\r\n        self.data.bound = true;\r\n        cssReset[CSS_TRANSFORM] = transformReset.toString();\r\n        cssReset[CSS_TRANS_ORG] = originReset.toString();\r\n        cssReset['opacity'] = 1;\r\n        css(img, cssReset);\r\n\r\n        imgData = self.elements.preview.getBoundingClientRect();\r\n\r\n        self._originalImageWidth = imgData.width;\r\n        self._originalImageHeight = imgData.height;\r\n        self.data.orientation = _hasExif.call(self) ? getExifOrientation(self.elements.img) : self.data.orientation;\r\n\r\n        if (self.options.enableZoom) {\r\n            _updateZoomLimits.call(self, true);\r\n        }\r\n        else {\r\n            self._currentZoom = initialZoom;\r\n        }\r\n\r\n        transformReset.scale = self._currentZoom;\r\n        cssReset[CSS_TRANSFORM] = transformReset.toString();\r\n        css(img, cssReset);\r\n\r\n        if (self.data.points.length) {\r\n            _bindPoints.call(self, self.data.points);\r\n        }\r\n        else {\r\n            _centerImage.call(self);\r\n        }\r\n\r\n        _updateCenterPoint.call(self);\r\n        _updateOverlay.call(self);\r\n    }\r\n\r\n    function _updateZoomLimits (initial) {\r\n        var self = this,\r\n            minZoom = Math.max(self.options.minZoom, 0) || 0,\r\n            maxZoom = self.options.maxZoom || 1.5,\r\n            initialZoom,\r\n            defaultInitialZoom,\r\n            zoomer = self.elements.zoomer,\r\n            scale = parseFloat(zoomer.value),\r\n            boundaryData = self.elements.boundary.getBoundingClientRect(),\r\n            imgData = naturalImageDimensions(self.elements.img, self.data.orientation),\r\n            vpData = self.elements.viewport.getBoundingClientRect(),\r\n            minW,\r\n            minH;\r\n        if (self.options.enforceBoundary) {\r\n            minW = vpData.width / imgData.width;\r\n            minH = vpData.height / imgData.height;\r\n            minZoom = Math.max(minW, minH);\r\n        }\r\n\r\n        if (minZoom >= maxZoom) {\r\n            maxZoom = minZoom + 1;\r\n        }\r\n\r\n        zoomer.min = fix(minZoom, 4);\r\n        zoomer.max = fix(maxZoom, 4);\r\n\r\n        if (!initial && (scale < zoomer.min || scale > zoomer.max)) {\r\n            _setZoomerVal.call(self, scale < zoomer.min ? zoomer.min : zoomer.max);\r\n        }\r\n        else if (initial) {\r\n            defaultInitialZoom = Math.max((boundaryData.width / imgData.width), (boundaryData.height / imgData.height));\r\n            initialZoom = self.data.boundZoom !== null ? self.data.boundZoom : defaultInitialZoom;\r\n            _setZoomerVal.call(self, initialZoom);\r\n        }\r\n\r\n        dispatchChange(zoomer);\r\n    }\r\n\r\n    function _bindPoints(points) {\r\n        if (points.length !== 4) {\r\n            throw \"Croppie - Invalid number of points supplied: \" + points;\r\n        }\r\n        var self = this,\r\n            pointsWidth = points[2] - points[0],\r\n            // pointsHeight = points[3] - points[1],\r\n            vpData = self.elements.viewport.getBoundingClientRect(),\r\n            boundRect = self.elements.boundary.getBoundingClientRect(),\r\n            vpOffset = {\r\n                left: vpData.left - boundRect.left,\r\n                top: vpData.top - boundRect.top\r\n            },\r\n            scale = vpData.width / pointsWidth,\r\n            originTop = points[1],\r\n            originLeft = points[0],\r\n            transformTop = (-1 * points[1]) + vpOffset.top,\r\n            transformLeft = (-1 * points[0]) + vpOffset.left,\r\n            newCss = {};\r\n\r\n        newCss[CSS_TRANS_ORG] = originLeft + 'px ' + originTop + 'px';\r\n        newCss[CSS_TRANSFORM] = new Transform(transformLeft, transformTop, scale).toString();\r\n        css(self.elements.preview, newCss);\r\n\r\n        _setZoomerVal.call(self, scale);\r\n        self._currentZoom = scale;\r\n    }\r\n\r\n    function _centerImage() {\r\n        var self = this,\r\n            imgDim = self.elements.preview.getBoundingClientRect(),\r\n            vpDim = self.elements.viewport.getBoundingClientRect(),\r\n            boundDim = self.elements.boundary.getBoundingClientRect(),\r\n            vpLeft = vpDim.left - boundDim.left,\r\n            vpTop = vpDim.top - boundDim.top,\r\n            w = vpLeft - ((imgDim.width - vpDim.width) / 2),\r\n            h = vpTop - ((imgDim.height - vpDim.height) / 2),\r\n            transform = new Transform(w, h, self._currentZoom);\r\n\r\n        css(self.elements.preview, CSS_TRANSFORM, transform.toString());\r\n    }\r\n\r\n    function _transferImageToCanvas(customOrientation) {\r\n        var self = this,\r\n            canvas = self.elements.canvas,\r\n            img = self.elements.img,\r\n            ctx = canvas.getContext('2d');\r\n\r\n        ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n        canvas.width = img.width;\r\n        canvas.height = img.height;\r\n\r\n        var orientation = self.options.enableOrientation && customOrientation || getExifOrientation(img);\r\n        drawCanvas(canvas, img, orientation);\r\n    }\r\n\r\n    function _getCanvas(data) {\r\n        var self = this,\r\n            points = data.points,\r\n            left = num(points[0]),\r\n            top = num(points[1]),\r\n            right = num(points[2]),\r\n            bottom = num(points[3]),\r\n            width = right-left,\r\n            height = bottom-top,\r\n            circle = data.circle,\r\n            canvas = document.createElement('canvas'),\r\n            ctx = canvas.getContext('2d'),\r\n            startX = 0,\r\n            startY = 0,\r\n            canvasWidth = data.outputWidth || width,\r\n            canvasHeight = data.outputHeight || height;\r\n\r\n        canvas.width = canvasWidth;\r\n        canvas.height = canvasHeight;\r\n\r\n        if (data.backgroundColor) {\r\n            ctx.fillStyle = data.backgroundColor;\r\n            ctx.fillRect(0, 0, canvasWidth, canvasHeight);\r\n        }\r\n\r\n        // By default assume we're going to draw the entire\r\n        // source image onto the destination canvas.\r\n        var sx = left,\r\n            sy = top,\r\n            sWidth = width,\r\n            sHeight = height,\r\n            dx = 0,\r\n            dy = 0,\r\n            dWidth = canvasWidth,\r\n            dHeight = canvasHeight;\r\n\r\n        //\r\n        // Do not go outside of the original image's bounds along the x-axis.\r\n        // Handle translations when projecting onto the destination canvas.\r\n        //\r\n\r\n        // The smallest possible source x-position is 0.\r\n        if (left < 0) {\r\n            sx = 0;\r\n            dx = (Math.abs(left) / width) * canvasWidth;\r\n        }\r\n\r\n        // The largest possible source width is the original image's width.\r\n        if (sWidth + sx > self._originalImageWidth) {\r\n            sWidth = self._originalImageWidth - sx;\r\n            dWidth =  (sWidth / width) * canvasWidth;\r\n        }\r\n\r\n        //\r\n        // Do not go outside of the original image's bounds along the y-axis.\r\n        //\r\n\r\n        // The smallest possible source y-position is 0.\r\n        if (top < 0) {\r\n            sy = 0;\r\n            dy = (Math.abs(top) / height) * canvasHeight;\r\n        }\r\n\r\n        // The largest possible source height is the original image's height.\r\n        if (sHeight + sy > self._originalImageHeight) {\r\n            sHeight = self._originalImageHeight - sy;\r\n            dHeight = (sHeight / height) * canvasHeight;\r\n        }\r\n\r\n        // console.table({ left, right, top, bottom, canvasWidth, canvasHeight, width, height, startX, startY, circle, sx, sy, dx, dy, sWidth, sHeight, dWidth, dHeight });\r\n\r\n        ctx.drawImage(this.elements.preview, sx, sy, sWidth, sHeight, dx, dy, dWidth, dHeight);\r\n        if (circle) {\r\n            ctx.fillStyle = '#fff';\r\n            ctx.globalCompositeOperation = 'destination-in';\r\n            ctx.beginPath();\r\n            ctx.arc(canvas.width / 2, canvas.height / 2, canvas.width / 2, 0, Math.PI * 2, true);\r\n            ctx.closePath();\r\n            ctx.fill();\r\n        }\r\n        return canvas;\r\n    }\r\n\r\n    function _getHtmlResult(data) {\r\n        var points = data.points,\r\n            div = document.createElement('div'),\r\n            img = document.createElement('img'),\r\n            width = points[2] - points[0],\r\n            height = points[3] - points[1];\r\n\r\n        addClass(div, 'croppie-result');\r\n        div.appendChild(img);\r\n        css(img, {\r\n            left: (-1 * points[0]) + 'px',\r\n            top: (-1 * points[1]) + 'px'\r\n        });\r\n        img.src = data.url;\r\n        css(div, {\r\n            width: width + 'px',\r\n            height: height + 'px'\r\n        });\r\n\r\n        return div;\r\n    }\r\n\r\n    function _getBase64Result(data) {\r\n        return _getCanvas.call(this, data).toDataURL(data.format, data.quality);\r\n    }\r\n\r\n    function _getBlobResult(data) {\r\n        var self = this;\r\n        return new Promise(function (resolve) {\r\n            _getCanvas.call(self, data).toBlob(function (blob) {\r\n                resolve(blob);\r\n            }, data.format, data.quality);\r\n        });\r\n    }\r\n\r\n    function _replaceImage(img) {\r\n        if (this.elements.img.parentNode) {\r\n            Array.prototype.forEach.call(this.elements.img.classList, function(c) { img.classList.add(c); });\r\n            this.elements.img.parentNode.replaceChild(img, this.elements.img);\r\n            this.elements.preview = img; // if the img is attached to the DOM, they're not using the canvas\r\n        }\r\n        this.elements.img = img;\r\n    }\r\n\r\n    function _bind(options, cb) {\r\n        var self = this,\r\n            url,\r\n            points = [],\r\n            zoom = null,\r\n            hasExif = _hasExif.call(self);\r\n\r\n        if (typeof (options) === 'string') {\r\n            url = options;\r\n            options = {};\r\n        }\r\n        else if (Array.isArray(options)) {\r\n            points = options.slice();\r\n        }\r\n        else if (typeof (options) === 'undefined' && self.data.url) { //refreshing\r\n            _updatePropertiesFromImage.call(self);\r\n            _triggerUpdate.call(self);\r\n            return null;\r\n        }\r\n        else {\r\n            url = options.url;\r\n            points = options.points || [];\r\n            zoom = typeof(options.zoom) === 'undefined' ? null : options.zoom;\r\n        }\r\n\r\n        self.data.bound = false;\r\n        self.data.url = url || self.data.url;\r\n        self.data.boundZoom = zoom;\r\n\r\n        return loadImage(url, hasExif).then(function (img) {\r\n            _replaceImage.call(self, img);\r\n            if (!points.length) {\r\n                var natDim = naturalImageDimensions(img);\r\n                var rect = self.elements.viewport.getBoundingClientRect();\r\n                var aspectRatio = rect.width / rect.height;\r\n                var imgAspectRatio = natDim.width / natDim.height;\r\n                var width, height;\r\n\r\n                if (imgAspectRatio > aspectRatio) {\r\n                    height = natDim.height;\r\n                    width = height * aspectRatio;\r\n                }\r\n                else {\r\n                    width = natDim.width;\r\n                    height = natDim.height / aspectRatio;\r\n                }\r\n\r\n                var x0 = (natDim.width - width) / 2;\r\n                var y0 = (natDim.height - height) / 2;\r\n                var x1 = x0 + width;\r\n                var y1 = y0 + height;\r\n                self.data.points = [x0, y0, x1, y1];\r\n            }\r\n            else if (self.options.relative) {\r\n                points = [\r\n                    points[0] * img.naturalWidth / 100,\r\n                    points[1] * img.naturalHeight / 100,\r\n                    points[2] * img.naturalWidth / 100,\r\n                    points[3] * img.naturalHeight / 100\r\n                ];\r\n            }\r\n\r\n            self.data.orientation = options.orientation || 1;\r\n            self.data.points = points.map(function (p) {\r\n                return parseFloat(p);\r\n            });\r\n            if (self.options.useCanvas) {\r\n                _transferImageToCanvas.call(self, self.data.orientation);\r\n            }\r\n            _updatePropertiesFromImage.call(self);\r\n            _triggerUpdate.call(self);\r\n            cb && cb();\r\n        });\r\n    }\r\n\r\n    function fix(v, decimalPoints) {\r\n        return parseFloat(v).toFixed(decimalPoints || 0);\r\n    }\r\n\r\n    function _get() {\r\n        var self = this,\r\n            imgData = self.elements.preview.getBoundingClientRect(),\r\n            vpData = self.elements.viewport.getBoundingClientRect(),\r\n            x1 = vpData.left - imgData.left,\r\n            y1 = vpData.top - imgData.top,\r\n            widthDiff = (vpData.width - self.elements.viewport.offsetWidth) / 2, //border\r\n            heightDiff = (vpData.height - self.elements.viewport.offsetHeight) / 2,\r\n            x2 = x1 + self.elements.viewport.offsetWidth + widthDiff,\r\n            y2 = y1 + self.elements.viewport.offsetHeight + heightDiff,\r\n            scale = self._currentZoom;\r\n\r\n        if (scale === Infinity || isNaN(scale)) {\r\n            scale = 1;\r\n        }\r\n\r\n        var max = self.options.enforceBoundary ? 0 : Number.NEGATIVE_INFINITY;\r\n        x1 = Math.max(max, x1 / scale);\r\n        y1 = Math.max(max, y1 / scale);\r\n        x2 = Math.max(max, x2 / scale);\r\n        y2 = Math.max(max, y2 / scale);\r\n\r\n        return {\r\n            points: [fix(x1), fix(y1), fix(x2), fix(y2)],\r\n            zoom: scale,\r\n            orientation: self.data.orientation\r\n        };\r\n    }\r\n\r\n    var RESULT_DEFAULTS = {\r\n            type: 'canvas',\r\n            format: 'png',\r\n            quality: 1\r\n        },\r\n        RESULT_FORMATS = ['jpeg', 'webp', 'png'];\r\n\r\n    function _result(options) {\r\n        var self = this,\r\n            data = _get.call(self),\r\n            opts = deepExtend(clone(RESULT_DEFAULTS), clone(options)),\r\n            resultType = (typeof (options) === 'string' ? options : (opts.type || 'base64')),\r\n            size = opts.size || 'viewport',\r\n            format = opts.format,\r\n            quality = opts.quality,\r\n            backgroundColor = opts.backgroundColor,\r\n            circle = typeof opts.circle === 'boolean' ? opts.circle : (self.options.viewport.type === 'circle'),\r\n            vpRect = self.elements.viewport.getBoundingClientRect(),\r\n            ratio = vpRect.width / vpRect.height,\r\n            prom;\r\n\r\n        if (size === 'viewport') {\r\n            data.outputWidth = vpRect.width;\r\n            data.outputHeight = vpRect.height;\r\n        } else if (typeof size === 'object') {\r\n            if (size.width && size.height) {\r\n                data.outputWidth = size.width;\r\n                data.outputHeight = size.height;\r\n            } else if (size.width) {\r\n                data.outputWidth = size.width;\r\n                data.outputHeight = size.width / ratio;\r\n            } else if (size.height) {\r\n                data.outputWidth = size.height * ratio;\r\n                data.outputHeight = size.height;\r\n            }\r\n        }\r\n\r\n        if (RESULT_FORMATS.indexOf(format) > -1) {\r\n            data.format = 'image/' + format;\r\n            data.quality = quality;\r\n        }\r\n\r\n        data.circle = circle;\r\n        data.url = self.data.url;\r\n        data.backgroundColor = backgroundColor;\r\n\r\n        prom = new Promise(function (resolve) {\r\n            switch(resultType.toLowerCase())\r\n            {\r\n                case 'rawcanvas':\r\n                    resolve(_getCanvas.call(self, data));\r\n                    break;\r\n                case 'canvas':\r\n                case 'base64':\r\n                    resolve(_getBase64Result.call(self, data));\r\n                    break;\r\n                case 'blob':\r\n                    _getBlobResult.call(self, data).then(resolve);\r\n                    break;\r\n                default:\r\n                    resolve(_getHtmlResult.call(self, data));\r\n                    break;\r\n            }\r\n        });\r\n        return prom;\r\n    }\r\n\r\n    function _refresh() {\r\n        _updatePropertiesFromImage.call(this);\r\n    }\r\n\r\n    function _rotate(deg) {\r\n        if (!this.options.useCanvas || !this.options.enableOrientation) {\r\n            throw 'Croppie: Cannot rotate without enableOrientation && EXIF.js included';\r\n        }\r\n\r\n        var self = this,\r\n            canvas = self.elements.canvas;\r\n\r\n        self.data.orientation = getExifOffset(self.data.orientation, deg);\r\n        drawCanvas(canvas, self.elements.img, self.data.orientation);\r\n        _updateCenterPoint.call(self, true);\r\n        _updateZoomLimits.call(self);\r\n\r\n        // Reverses image dimensions if the degrees of rotation is not divisible by 180.\r\n        if ((Math.abs(deg) / 90) % 2 === 1) {\r\n            var oldHeight = self._originalImageHeight;\r\n            var oldWidth = self._originalImageWidth;\r\n            self._originalImageWidth = oldHeight;\r\n            self._originalImageHeight = oldWidth;\r\n        }\r\n    }\r\n\r\n    function _destroy() {\r\n        var self = this;\r\n        self.element.removeChild(self.elements.boundary);\r\n        removeClass(self.element, 'croppie-container');\r\n        if (self.options.enableZoom) {\r\n            self.element.removeChild(self.elements.zoomerWrap);\r\n        }\r\n        delete self.elements;\r\n    }\r\n\r\n    if (typeof window !== 'undefined' && window.jQuery) {\r\n        var $ = window.jQuery;\r\n        $.fn.croppie = function (opts) {\r\n            var ot = typeof opts;\r\n\r\n            if (ot === 'string') {\r\n                var args = Array.prototype.slice.call(arguments, 1);\r\n                var singleInst = $(this).data('croppie');\r\n\r\n                if (opts === 'get') {\r\n                    return singleInst.get();\r\n                }\r\n                else if (opts === 'result') {\r\n                    return singleInst.result.apply(singleInst, args);\r\n                }\r\n                else if (opts === 'bind') {\r\n                    return singleInst.bind.apply(singleInst, args);\r\n                }\r\n\r\n                return this.each(function () {\r\n                    var i = $(this).data('croppie');\r\n                    if (!i) return;\r\n\r\n                    var method = i[opts];\r\n                    if ($.isFunction(method)) {\r\n                        method.apply(i, args);\r\n                        if (opts === 'destroy') {\r\n                            $(this).removeData('croppie');\r\n                        }\r\n                    }\r\n                    else {\r\n                        throw 'Croppie ' + opts + ' method not found';\r\n                    }\r\n                });\r\n            }\r\n            else {\r\n                return this.each(function () {\r\n                    var i = new Croppie(this, opts);\r\n                    i.$ = $;\r\n                    $(this).data('croppie', i);\r\n                });\r\n            }\r\n        };\r\n    }\r\n\r\n    function Croppie(element, opts) {\r\n        if (element.className.indexOf('croppie-container') > -1) {\r\n            throw new Error(\"Croppie: Can't initialize croppie more than once\");\r\n        }\r\n        this.element = element;\r\n        this.options = deepExtend(clone(Croppie.defaults), opts);\r\n\r\n        if (this.element.tagName.toLowerCase() === 'img') {\r\n            var origImage = this.element;\r\n            addClass(origImage, 'cr-original-image');\r\n            setAttributes(origImage, {'aria-hidden' : 'true', 'alt' : '' });\r\n            var replacementDiv = document.createElement('div');\r\n            this.element.parentNode.appendChild(replacementDiv);\r\n            replacementDiv.appendChild(origImage);\r\n            this.element = replacementDiv;\r\n            this.options.url = this.options.url || origImage.src;\r\n        }\r\n\r\n        _create.call(this);\r\n        if (this.options.url) {\r\n            var bindOpts = {\r\n                url: this.options.url,\r\n                points: this.options.points\r\n            };\r\n            delete this.options['url'];\r\n            delete this.options['points'];\r\n            _bind.call(this, bindOpts);\r\n        }\r\n    }\r\n\r\n    Croppie.defaults = {\r\n        viewport: {\r\n            width: 100,\r\n            height: 100,\r\n            type: 'square'\r\n        },\r\n        boundary: { },\r\n        orientationControls: {\r\n            enabled: true,\r\n            leftClass: '',\r\n            rightClass: ''\r\n        },\r\n        resizeControls: {\r\n            width: true,\r\n            height: true\r\n        },\r\n        customClass: '',\r\n        showZoomer: true,\r\n        enableZoom: true,\r\n        enableResize: false,\r\n        mouseWheelZoom: true,\r\n        enableExif: false,\r\n        enforceBoundary: true,\r\n        enableOrientation: false,\r\n        enableKeyMovement: true,\r\n        update: function () { }\r\n    };\r\n\r\n    Croppie.globals = {\r\n        translate: 'translate3d'\r\n    };\r\n\r\n    deepExtend(Croppie.prototype, {\r\n        bind: function (options, cb) {\r\n            return _bind.call(this, options, cb);\r\n        },\r\n        get: function () {\r\n            var data = _get.call(this);\r\n            var points = data.points;\r\n            if (this.options.relative) {\r\n                points[0] /= this.elements.img.naturalWidth / 100;\r\n                points[1] /= this.elements.img.naturalHeight / 100;\r\n                points[2] /= this.elements.img.naturalWidth / 100;\r\n                points[3] /= this.elements.img.naturalHeight / 100;\r\n            }\r\n            return data;\r\n        },\r\n        result: function (type) {\r\n            return _result.call(this, type);\r\n        },\r\n        refresh: function () {\r\n            return _refresh.call(this);\r\n        },\r\n        setZoom: function (v) {\r\n            _setZoomerVal.call(this, v);\r\n            dispatchChange(this.elements.zoomer);\r\n        },\r\n        rotate: function (deg) {\r\n            _rotate.call(this, deg);\r\n        },\r\n        destroy: function () {\r\n            return _destroy.call(this);\r\n        }\r\n    });\r\n    return Croppie;\r\n}));"],"names":["root","factory","self","this","Promise","a","b","apply","arguments","c","TypeError","_state","_value","_deferreds","i","e","f","d","push","k","onFulfilled","onRejected","reject","resolve","then","g","call","length","h","j","setTimeout","setImmediate","l","Array","isArray","Object","prototype","toString","all","slice","constructor","race","_setImmediateFn","module","exports","window","CustomEvent","event","params","bubbles","cancelable","detail","undefined","evt","document","createEvent","initCustomEvent","Event","HTMLCanvasElement","toBlob","defineProperty","value","callback","type","quality","binStr","atob","toDataURL","split","len","arr","Uint8Array","charCodeAt","Blob","CSS_TRANS_ORG","CSS_TRANSFORM","CSS_USERSELECT","cssPrefixes","emptyStyles","createElement","style","EXIF_NORM","EXIF_FLIP","vendorPrefix","prop","capProp","toUpperCase","deepExtend","destination","source","property","clone","object","dispatchChange","element","initEvent","dispatchEvent","fireEvent","css","el","styles","val","tmp","addClass","classList","add","className","setAttributes","attrs","key","setAttribute","num","v","parseInt","naturalImageDimensions","img","ornt","w","naturalWidth","naturalHeight","orient","getExifOrientation","x","width","height","TRANSLATE_OPTS","suffix","Transform","y","scale","parseFloat","parse","indexOf","fromMatrix","fromString","vals","substring","values","translate","Croppie","globals","TransformOrigin","exifdata","Orientation","drawCanvas","canvas","orientation","ctx","getContext","save","rotate","Math","PI","drawImage","restore","_create","boundary","viewport","overlay","bw","bh","customViewportClass","options","useCanvas","enableOrientation","_hasExif","data","elements","preview","isNaN","appendChild","customClass","_initDraggable","enableZoom","_initializeZoom","enableResize","_initializeResize","enableExif","EXIF","direction","originalX","originalY","maxWidth","maxHeight","vr","hr","wrap","isDragging","mouseDown","ev","button","preventDefault","overlayRect","getBoundingClientRect","pageX","pageY","currentTarget","touches","addEventListener","mouseMove","mouseUp","body","deltaX","deltaY","newHeight","newWidth","_updateOverlay","_updateZoomLimits","_updateCenterPoint","_triggerUpdate","removeEventListener","resizeControls","_setZoomerVal","z","zoomer","fix","max","min","zoomerWrap","change","_onZoom","origin","viewportRect","transform","scroll","delta","targetZoom","mouseWheelZoom","ctrlKey","wheelDelta","_currentZoom","step","display","showZoomer","ui","vpRect","applyCss","transCss","enforceBoundary","boundaries","_getVirtualBoundaries","transBoundaries","oBoundaries","maxX","minX","maxY","minY","_debouncedOverlay","vpWidth","vpHeight","centerFromBoundaryX","clientWidth","centerFromBoundaryY","clientHeight","imgRect","curImgWidth","curImgHeight","halfWidth","halfHeight","originMinX","originMinY","vpData","pc","top","left","center","adj","cx","cy","tx","ty","newCss","originalDistance","assignTransformCoordinates","bottom","right","toggleGrabState","touch1","touch2","dist","sqrt","zoom","shiftKey","keyCode","enableKeyMovement","movement","parseKeyDown","keyMove","setZoom","boundRect","imgData","func","wait","immediate","timeout","context","args","later","callNow","clearTimeout","get","_isVisible","update","$","Prototype","trigger","offsetHeight","offsetWidth","_updatePropertiesFromImage","cssReset","transformReset","originReset","bound","_originalImageWidth","_originalImageHeight","points","_bindPoints","_centerImage","initial","initialZoom","defaultInitialZoom","minW","minH","minZoom","maxZoom","boundaryData","boundZoom","pointsWidth","vpOffset","originTop","originLeft","transformTop","transformLeft","imgDim","vpDim","boundDim","vpLeft","vpTop","_transferImageToCanvas","customOrientation","clearRect","_getCanvas","circle","canvasWidth","outputWidth","canvasHeight","outputHeight","backgroundColor","fillStyle","fillRect","sx","sy","sWidth","sHeight","dx","dy","dWidth","dHeight","abs","globalCompositeOperation","beginPath","arc","closePath","fill","_getHtmlResult","div","src","url","_getBase64Result","format","_getBlobResult","blob","_replaceImage","parentNode","forEach","replaceChild","_bind","cb","hasExif","doExif","Image","opacity","_resolve","removeAttribute","match","onload","getData","onerror","loadImage","relative","natDim","rect","aspectRatio","x0","y0","x1","y1","map","p","decimalPoints","toFixed","_get","widthDiff","heightDiff","x2","y2","Infinity","Number","NEGATIVE_INFINITY","RESULT_DEFAULTS","RESULT_FORMATS","_result","opts","resultType","size","ratio","_typeof","toLowerCase","_refresh","_rotate","deg","index","offset","oldHeight","oldWidth","_destroy","removeChild","remove","replace","jQuery","fn","croppie","ot","singleInst","result","bind","each","method","isFunction","removeData","Error","defaults","tagName","origImage","replacementDiv","bindOpts","orientationControls","enabled","leftClass","rightClass","refresh","destroy","define","amd","nodeName"],"mappings":"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"}